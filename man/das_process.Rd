% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/das_process.R
\name{das_process}
\alias{das_process}
\alias{das_process.character}
\alias{das_process.data.frame}
\alias{das_process.tbl_df}
\alias{das_process.das_dfr}
\title{Process DAS data}
\usage{
das_process(x, ...)

\method{das_process}{character}(x, ...)

\method{das_process}{data.frame}(x, ...)

\method{das_process}{tbl_df}(x, ...)

\method{das_process}{das_dfr}(x, days.gap = 10, reset.event = TRUE, reset.day = TRUE, ...)
}
\arguments{
\item{x}{either a \code{das_dfr} object (the output of \code{\link{das_read}}),
or a character (filepath) which is first passed to \code{\link{das_read}}}

\item{...}{ignored}

\item{days.gap}{numeric of length 1; time gap (in days) used to identify
a new cruise in concatenated DAS files, and thus also when
state/condition information (weather, Bft, Mode, etc) is reset.
Default is 10 days}

\item{reset.event}{logical; indicates if state/condition information
(weather, Bft, Mode, etc) should be reset to \code{NA} if there is an
applicable event with an \code{NA} for that state/condition}

\item{reset.day}{logical; indicates if state/condition information
(weather, Bft, Mode, etc) should be reset to \code{NA} at the beginning of each day.
This argument should only be set to \code{FALSE}
for comparison with older methods, such as Report}
}
\value{
A \code{das_df} object, which is also a data frame.
  It consists of the input data frame, i.e. the output of \code{\link{das_read}},
  with the following columns added:
  \tabular{ll}{
    \emph{State/condition}        \tab \emph{Column name}\cr
    On/off effort                 \tab OnEffort\cr
    Cruise number                 \tab Cruise\cr
    Effort mode                   \tab Mode\cr
    Effort type                   \tab EffType\cr
    Course (ship direction)       \tab Course\cr
    Beaufort sea state            \tab Bft\cr
    Swell height (ft)             \tab SwellHght\cr
    Rain/fog/haze code            \tab RainFog\cr
    Horizontal sun (clock system) \tab HorizSun\cr
    Vertical sun (clock system)   \tab VertSun\cr
    Glare                         \tab Glare\cr
    Visibility (nm)               \tab Vis\cr
  }
}
\description{
Process DAS data (the output of \code{\link{das_read}}),
  including extracting state and condition information for each DAS event
}
\details{
If \code{x} is a character, it is assumed to be a filepath and first passed to \code{\link{das_read}}.
  This output is then passed to \code{das_process}.

  DAS data is event-based, meaning most events indicate when a state or weather condition changes.
  For instance, a 'V' event indicates when the Beaufort sea state changes, and
  the Beaufort is the same for subsequent events until the next 'V' event.
  For each state/condition: a new column is created,
  the state/condition information is extracted from relevant events,
  and extracted information is propagated to appropriate subsequent rows (events).
  Thus, each row in the output data frame contains all
  pertinent state/condition information for that row.

  The following assumptions/decisions are made during processing:
  \itemize{
    \item Event codes are expected to be one of the following:
      #, *, ?, 1, 2, 3, 4, 5, 6, 7, 8, A, B, C, E, F, k, K, N, P, Q, R, s, S, t, V, W
    \item All '#' events (deleted events) are removed
    \item An event is considered 'on effort' if it is 1) an R event,
      2) a B event immediately preceding an R event, or 3) between corresponding R and E events.
      The 'EffortDot' column is ignored
    \item All state/condition information is reset at the beginning of each cruise.
      New cruises are identifed using \code{days.gap}.
    \item 'Mode' is capitalized, and 'Mode' values of \code{NA} are assigned a value of "C"
    \item 'EffType' is capitalized, and values of \code{NA} are assigned a value of "S"
    \item 'Glare': \code{TRUE} if 'HzSun' is 11, 12 or 1 and 'VtSun' is 2 or 3,
      or if 'HzSun' is 12 and 'VtSun' is 1;
      \code{NA} if 'HzSun' or 'VtSun' is \code{NA};
      otherwise \code{FALSE}
    \item Missing values are \code{NA} rather than \code{-1}
  }

  This function was inspired by \code{\link[swfscMisc]{das.read}}
}
\examples{
y <- system.file("das_sample.das", package = "swfscDAS")
das_process(y)

y.read <- das_read(y)
das_process(y.read)

}
\seealso{
For more details about WinCruz, see
  \url{https://swfsc.noaa.gov/uploadedFiles/Divisions/PRD/WinCruz.pdf}
}
